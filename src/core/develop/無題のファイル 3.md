# 開発効率化ソフトによる「ドメイン逆算設計」の実現
---
## スライド1: タイトルページ

### 開発効率化ソフトによる「ドメイン逆算設計」の実現

#### 〜 既存DB資産を活かした高速・高保守性な開発フロー 〜
---
## スライド2: 開発現場の課題

### 既存DBを前に、私たちはどこから手を付けるべきか？

- **課題1: ブラックボックス化**
    
    - 既存DBのテーブル構造が複雑で、どこから手をつけて良いかわからない。
        
- **課題2: 設計の属人化**
    
    - 設計者によってServiceの粒度やRepositoryの作り方がバラバラになる。
        
- **課題3: 影響範囲の不明瞭さ**
    
    - 「このテーブルを変更したら、どの機能に影響が出るか」が瞬時に把握できない。
        
- **課題4: 手戻りの発生**
    
    - 設計の不整合（循環依存など）が実装段階で発覚し、大きな手戻りが発生する。
        
---
## スライド3: 解決アプローチ：「ドメイン逆算設計」

### 「DB → ドメイン → Service」の流れで設計を体系化する

ご提示いただいた「ドメインから逆算する」思考フローを採用します。

1. **【DBの分析】**
    
    - 既存のテーブル群を分析する。
        
2. **【ドメインの決定】**
    
    - 関連するテーブルを「機能ドメイン（例：ユーザー管理、商品管理）」にグルーピングする。
        
3. **【ユースケースの抽出】**
    
    - そのドメインが何をすべきか（ユースケース）を洗い出す。
        
4. **【Serviceの設計】**
    
    - ユースケースを実現するためのビジネスロジック（Service）を定義する。
        
5. **【Repositoryの設計】**
    
    - Serviceが必要とするデータアクセス（Repository）を定義する。
        
---
## スライド4: 提案：開発効率化ソフト「（製品名）」

### 設計フロー全体を一元管理・可視化・自動化する

この「ドメイン逆算設計」の全ステップを強力に支援するソフトウェアを提案します。

|   |   |
|---|---|
|**管理モジュール**|**役割**|
|**DBスキーマ管理**|既存DBのテーブル構造をインポート|
|**ドメイン管理**|テーブルを機能ドメインに紐付け|
|**ユースケース管理**|ドメインの「操作」を定義|
|**サービス管理**|ビジネスロジックのI/Fを設計|
|**レポジトリ管理**|データアクセスのI/Fを設計|
|**依存関係管理**|レイヤー間の依存性を可視化|
|**コード生成**|設計情報から雛形コードを自動生成|
---
## スライド5: STEP 1 & 2: DBからドメイン・ユースケースへ

### 「テーブルの群れ」を「意味のある機能単位」へ変換する

- **（A）DBスキーマ管理**
    
    - `users`, `user_profiles`, `user_login_history` ...
        
    - `products`, `product_categories`, `product_stock` ...
        
- **（B）ドメイン管理**
    
    - （A）のテーブル群をグルーピング
        
    - **[ドメイン：ユーザー管理]**
        
        - `users`, `user_profiles`, `user_login_history`
            
    - **[ドメイン：商品管理]**
        
        - `products`, `product_categories`, `product_stock`
            
- **（C）ユースケース管理**
    
    - [ドメイン：ユーザー管理]
        
        - `UC-01: ユーザーを新規登録する`
            
        - `UC-02: ユーザー情報を更新する`
            
---
## スライド6: STEP 3: ユースケースからServiceへ

### 「何をするか」から「どう実現するか」のI/Fを設計する

- ユースケースを実現するビジネスロジックの「窓口」を定義します。
    

|   |   |   |
|---|---|---|
|**ユースケース**|**サービス (Service)**|**サービスメソッド (Method)**|
|`UC-01: ユーザーを新規登録する`|`UserService`|`createUser(dto: CreateUserDto)`|
|`UC-02: ユーザー情報を更新する`|`UserService`|`updateUser(id: string, dto: UpdateUserDto)`|
|`UC-03: ユーザーを退会させる`|`UserService`|`deactivateUser(id: string)`|
|`UC-11: 商品を登録する`|`ProductService`|`createProduct(dto: CreateProductDto)`|
---
## スライド7: STEP 4: ServiceからRepositoryへ

### 「ビジネスロジック」と「データアクセス」を分離する

- Serviceが必要とする「データ操作」をRepositoryに委譲します。
    

|   |   |   |
|---|---|---|
|**サービスメソッド (Method)**|**レポジトリ (Repository)**|**レポジトリメソッド (Method)**|
|`UserService.createUser(...)`|`UserRepository`|`create(data: User)`<br><br>  <br><br>`findByEmail(email: string)`|
|`UserService.getUser(id)`|`UserRepository`|`findById(id: string)`|
|`ProductService.createProduct(...)`|`ProductRepository`|`create(data: Product)`|

**ポイント：** Serviceは「どのテーブルか」を意識せず、Repositoryのメソッドを呼び出すだけ。
---
## スライド8: STEP 5: 依存関係の可視化と整理

### 設計の「健全性」をグラフで担保する

- 「誰が」「何を」使っているかを可視化し、設計上の問題を早期に発見します。
    
- **可視化できること**
    
    - `UserService` が `UserRepository` と `LoginHistoryRepository` に依存している。
        
    - `ProductService` が `ProductRepository` に依存している。
        
- **検知できる問題**
    
    - **循環依存** (ServiceA ⇄ ServiceB)
        
    - **不正な依存** (Repository → Service など)
        
    - **未使用のRepository**（リファクタリング対象）
        
---
## スライド9: ツールの主な機能 (1) - 設計管理

### 全ての設計情報を一元管理

|   |   |
|---|---|
|**管理モジュール**|**主な機能**|
|**DBスキーマ管理**|・DBからスキーマ情報をインポート<br><br>  <br><br>・テーブル定義（カラム、型）の閲覧|
|**ドメイン管理**|・ドメインの作成<br><br>  <br><br>・テーブルをドメインにドラッグ＆ドロップで紐付け|
|**ユースケース管理**|・ドメインに紐づくユースケースの登録<br><br>  <br><br>・シナリオやアクターの記述|
|**サービス管理**|・Serviceの作成<br><br>  <br><br>・メソッド（I/F、DTO）の定義<br><br>  <br><br>・ユースケースとの紐付け|
|**レポジトリ管理**|・Repositoryの作成<br><br>  <br><br>・メソッド（I/F）の定義<br><br>  <br><br>・操作対象テーブルの紐付け|
---
## スライド10: ツールの主な機能 (2) - 可視化・分析

### 「見えない依存」を見えるようにする

|   |   |
|---|---|
|**機能**|**目的・メリット**|
|**依存関係グラフ**|・レイヤー間の依存関係をグラフ化<br><br>  <br><br>・循環依存や不正な依存を自動検出|
|**データフロー図**|・特定のユースケースがどのService/Repositoryを通るか可視化<br><br>  <br><br>・処理の流れを直感的に理解|
|**影響範囲分析**|・「このテーブル（メソッド）を変更したら、どこに影響が出るか」を瞬時に逆引き<br><br>  <br><br>・変更時の影響調査コストを激減|
---
## スライド11: ツールの主な機能 (3) - コード自動生成

### 「設計」から「実装」へシームレスに連携

- 設計情報（Service/Repositoryの定義）は、ボタン一つでコード化。
    
- 実装者は「ビジネスロジックの中身」の記述に集中できます。
    

**自動生成されるコードの例:**

- **型定義ファイル** (`types/user.dto.ts`)
    
- **Serviceインターフェース** (`services/user.service.interface.ts`)
    
- **Repositoryインターフェース** (`repositories/user.repository.interface.ts`)
    
- **雛形クラスファイル** (`services/user.service.ts`)
    
---
## スライド12: 導入効果とまとめ

### 「ドメイン逆算設計」で開発を次のステージへ

1. **品質の向上**
    
    - レイヤー分離が徹底され、高保守性・高テスト性を実現。
        
    - 循環依存などの設計上の問題を早期に検出。
        
2. **開発速度の向上**
    
    - 雛形コードの自動生成により、実装の立ち上がりを高速化。
        
    - 影響範囲の分析コストを大幅に削減。
        
3. **属人化の排除**
    
    - 「ドメイン逆算設計」という共通の設計プロセスがチームに定着。
        
    - 設計情報が一元管理され、ブラックボックス化を防止。